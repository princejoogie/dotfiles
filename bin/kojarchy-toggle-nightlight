#!/bin/bash

# Toggle hyprsunset nightlight filter between warm (4000K) and neutral (6000K).
# Uses hyprctl to set temperature instead of killing the process.

ON_TEMP=4000
OFF_TEMP=6000

# Ensure hyprsunset is running
if ! pgrep -x hyprsunset > /dev/null; then
  setsid hyprsunset &
  sleep 1
fi

# Query current temperature
CURRENT_TEMP=$(hyprctl hyprsunset temperature 2>/dev/null | grep -oE '[0-9]+')

if [[ "$CURRENT_TEMP" == "$OFF_TEMP" ]]; then
  hyprctl hyprsunset temperature $ON_TEMP
  notify-send "Nightlight on" "Temperature set to ${ON_TEMP}K"
else
  hyprctl hyprsunset temperature $OFF_TEMP
  notify-send "Nightlight off" "Temperature set to ${OFF_TEMP}K"
fi
